<!-- src/app/pages/daily-tasks/daily-tasks.component.html -->
<div class="daily-tasks-container rrpg-root">
  <!-- iOS + Android Compatibility (inline like previous pages) -->
  <style>
    * { box-sizing: border-box; }
    :root{
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --safe-left: env(safe-area-inset-left, 0px);
      --safe-right: env(safe-area-inset-right, 0px);
    }
    /* Root: fixes iOS 100vh + random horizontal scroll */
    .rrpg-root{
      width: 100%;
      min-height: 100vh; /* fallback */
      min-height: 100dvh; /* correct for modern iOS/Android */
      overflow-x: clip; /* avoid iOS sideways scroll */
      background: #f3f4f6;
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      display: flex;
      flex-direction: column;
      -webkit-text-size-adjust: 100%;
      overscroll-behavior: none;
      -webkit-overflow-scrolling: touch;
    }
    /* Header: make it notch-safe */
    .tasks-header{
      position: relative;
      padding-top: calc(1.25rem + var(--safe-top));
      padding-left: calc(1rem + var(--safe-left));
      padding-right: calc(1rem + var(--safe-right));
      padding-bottom: 1rem;
    }
    /* Back button */
    .back-btn{
      position: absolute;
      top: calc(0.9rem + var(--safe-top));
      left: calc(0.9rem + var(--safe-left));
      width: 42px;
      height: 42px;
      border-radius: 999px;
      border: 1px solid rgba(17, 24, 39, 0.12);
      background: rgba(255,255,255,0.92);
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      z-index: 5;
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .back-btn:active{
      transform: scale(0.98);
      box-shadow: 0 8px 18px rgba(15, 23, 42, 0.10);
    }
    /* Make space so title doesn't overlap with back button */
    .header-content{
      padding-left: 52px;
    }
    /* Main grid wrapper padding: bottom safe area so button not hidden behind home bar */
    .tasks-grid{
      padding-left: calc(1rem + var(--safe-left));
      padding-right: calc(1rem + var(--safe-right));
    }
    /* Submit section: safe-area bottom padding */
    .submit-section{
      padding-left: calc(1rem + var(--safe-left));
      padding-right: calc(1rem + var(--safe-right));
      padding-bottom: calc(1rem + var(--safe-bottom));
    }
    /* Better iOS tap feel */
    .task-card, .submit-btn, .toggle-switch{
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
  </style>

  <header class="tasks-header">
    <!-- ‚úÖ Back button - KEPT -->
    <button class="back-btn" type="button" (click)="goBackToDashboard()" aria-label="Back">
      <span style="font-size: 18px; line-height: 1;">‚Üê</span>
    </button>

    <div class="header-content">
      <h1>Daily Spiritual Tasks</h1>
      <p class="subtitle">Complete your daily sadhana and earn points</p>
      <div class="points-summary">
        <span class="total-points">
          Today's Points: <strong>{{ earnedPoints }} / 70</strong>
        </span>
        <span class="streak">Streak: <strong>{{ streak }} days</strong></span>
      </div>
    </div>
  </header>

  <div class="tasks-grid">
    <!-- Task 1: ‡§™‡§æ‡§¶‡§µ‡§ø‡§π‡§æ‡§∞‡•Ä -->
    <div class="task-card" [class.completed]="tasks[0].completed">
      <div class="task-icon">üö∂</div>
      <div class="task-content">
        <h3>‡§™‡§æ‡§¶‡§µ‡§ø‡§π‡§æ‡§∞‡•Ä</h3>
        <p class="task-desc">‡§∏‡•ç‡§µ‡§∏‡•ç‡§• ‡§ú‡•Ä‡§µ‡§® ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ</p>
        <div class="points">+10 pts</div>
      </div>
      <label class="toggle-switch">
        <input type="checkbox" [(ngModel)]="tasks[0].completed" (change)="updatePoints()">
        <span class="slider"></span>
      </label>
    </div>

    <!-- Task 2: ‡§≠‡•Ç‡§Æ‡§ø ‡§∏‡§Ç‡§µ‡§∞‡•Ä -->
    <div class="task-card" [class.completed]="tasks[1].completed">
      <div class="task-icon">üåø</div>
      <div class="task-content">
        <h3>‡§≠‡•Ç‡§Æ‡§ø ‡§∏‡§Ç‡§µ‡§∞‡•Ä</h3>
        <p class="task-desc">‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§µ‡§ø‡§∂‡•ç‡§∞‡§æ‡§Æ</p>
        <div class="points">+10 pts</div>
      </div>
      <label class="toggle-switch">
        <input type="checkbox" [(ngModel)]="tasks[1].completed" (change)="updatePoints()">
        <span class="slider"></span>
      </label>
    </div>

    <!-- Task 3: ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§ö‡§æ‡§∞‡•Ä -->
    <div class="task-card" [class.completed]="tasks[2].completed">
      <div class="task-icon">üïâÔ∏è</div>
      <div class="task-content">
        <h3>‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§ö‡§æ‡§∞‡•Ä</h3>
        <p class="task-desc">‡§∏‡§Ç‡§Ø‡§Æ‡§ø‡§§ ‡§ú‡•Ä‡§µ‡§®</p>
        <div class="points">+10 pts</div>
      </div>
      <label class="toggle-switch">
        <input type="checkbox" [(ngModel)]="tasks[2].completed" (change)="updatePoints()">
        <span class="slider"></span>
      </label>
    </div>

    <!-- Task 4: ‡§∏‡§ö‡§ø‡§§‡•ç‡§§‡§æ‡§π‡§æ‡§∞‡•Ä -->
    <div class="task-card" [class.completed]="tasks[3].completed">
      <div class="task-icon">üçΩÔ∏è</div>
      <div class="task-content">
        <h3>‡§∏‡§ö‡§ø‡§§‡•ç‡§§‡§æ‡§π‡§æ‡§∞‡•Ä</h3>
        <p class="task-desc">‡§∏‡§æ‡§§‡•ç‡§µ‡§ø‡§ï ‡§Ü‡§π‡§æ‡§∞</p>
        <div class="points">+10 pts</div>
      </div>
      <label class="toggle-switch">
        <input type="checkbox" [(ngModel)]="tasks[3].completed" (change)="updatePoints()">
        <span class="slider"></span>
      </label>
    </div>

    <!-- Task 5: ‡§´‡§≤‡§æ‡§π‡§æ‡§∞‡•Ä -->
    <div class="task-card" [class.completed]="tasks[4].completed">
      <div class="task-icon">üçé</div>
      <div class="task-content">
        <h3>‡§è‡§ï‡§æ‡§π‡§æ‡§∞‡•Ä</h3>
        <p class="task-desc">‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§™‡•ã‡§∑‡§£</p>
        <div class="points">+10 pts</div>
      </div>
      <label class="toggle-switch">
        <input type="checkbox" [(ngModel)]="tasks[4].completed" (change)="updatePoints()">
        <span class="slider"></span>
      </label>
    </div>

    <!-- Task 6: ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ‡§µ‡§æ‡§¶‡•Ä -->
    <div class="task-card" [class.completed]="tasks[5].completed">
      <div class="task-icon">üôè</div>
      <div class="task-content">
        <h3>‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ‡§µ‡§æ‡§¶‡•Ä</h3>
        <p class="task-desc">‡§∏‡§∞‡§≤ ‡§ú‡•Ä‡§µ‡§®</p>
        <div class="points">+10 pts</div>
      </div>
      <label class="toggle-switch">
        <input type="checkbox" [(ngModel)]="tasks[5].completed" (change)="updatePoints()">
        <span class="slider"></span>
      </label>
    </div>

    <!-- Task 7: ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§Æ‡§£ -->
    <div class="task-card" [class.completed]="tasks[6].completed">
      <div class="task-icon">ü™î</div>
      <div class="task-content">
        <h3>‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§Æ‡§£</h3>
        <p class="task-desc">‡§Ü‡§§‡•ç‡§Æ‡§∂‡•Å‡§¶‡•ç‡§ß‡§ø ‡§∏‡§æ‡§ß‡§®‡§æ</p>
        <div class="points">+10 pts</div>
      </div>
      <label class="toggle-switch">
        <input type="checkbox" [(ngModel)]="tasks[6].completed" (change)="updatePoints()">
        <span class="slider"></span>
      </label>
    </div>
  </div>

  <div class="submit-section">
    <button class="submit-btn" (click)="submitTasks()" [disabled]="!anyTaskCompleted">
      Submit Today's Progress
    </button>
    <p class="note">Tasks reset daily at 12:00 AM</p>
  </div>
</div>